import math
import pandas as pd

def norm_col(s):
    if s is None:
        return ""
    return str(s).strip()

def norm_key(v):
    if pd.isna(v):
        return ""
    return str(v).strip()

def norm_val(v):
    if v is None:
        return ""
    if isinstance(v, float) and math.isnan(v):
        return ""
    if pd.isna(v):
        return ""
    if isinstance(v, str):
        return v.strip()
    return v

def values_equal(v1, v2):
    norm_v1 = norm_val(v1)
    norm_v2 = norm_val(v2)
    return norm_v1 == norm_v2